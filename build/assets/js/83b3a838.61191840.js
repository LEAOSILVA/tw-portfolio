"use strict";(self.webpackChunkmy_website=self.webpackChunkmy_website||[]).push([[2867],{4141:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>l,contentTitle:()=>o,default:()=>h,frontMatter:()=>r,metadata:()=>s,toc:()=>d});const s=JSON.parse('{"id":"docs-example/scripts","title":"Script","description":"Context","source":"@site/docs/docs-example/scripts.md","sourceDirName":"docs-example","slug":"/docs-example/scripts","permalink":"/tw-portfolio/docs/docs-example/scripts","draft":false,"unlisted":false,"tags":[],"version":"current","sidebarPosition":7,"frontMatter":{"sidebar_position":7},"sidebar":"docsSidebar","previous":{"title":"Release notes","permalink":"/tw-portfolio/docs/docs-example/release-notes"},"next":{"title":"Tutorials","permalink":"/tw-portfolio/docs/docs-example/Available tutorials/"}}');var i=t(4848),a=t(8453);const r={sidebar_position:7},o="Script",l={},d=[{value:"Data transformation with JSONata",id:"data-transformation-with-jsonata",level:2},{value:"Body transformation with JSONata",id:"body-transformation-with-jsonata",level:3},{value:"Adding a log step",id:"adding-a-log-step",level:3},{value:"Creating a resource",id:"creating-a-resource",level:3},{value:"Using the JSONata component",id:"using-the-jsonata-component",level:3},{value:"Adding another log step",id:"adding-another-log-step",level:3},{value:"Checking logs and traces",id:"checking-logs-and-traces",level:3}];function c(e){const n={blockquote:"blockquote",br:"br",code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,a.R)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(n.header,{children:(0,i.jsx)(n.h1,{id:"script",children:"Script"})}),"\n",(0,i.jsxs)(n.blockquote,{children:["\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Context"})}),"\n",(0,i.jsx)(n.p,{children:"The excerpt below comes from a training session that walks users through the creation of an integration flow, guiding them step by step from start to finish. It includes detailed configurations for each step, along with the corresponding logs and traces."}),"\n",(0,i.jsxs)(n.p,{children:["For clarity, the flow steps are summarized below. We will focus on ",(0,i.jsx)(n.strong,{children:"Step 5: Data transformation with JSONata"}),"."]}),"\n"]}),"\n",(0,i.jsxs)(n.ol,{children:["\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Order received with a REST trigger"}),(0,i.jsx)(n.br,{}),"\n","The flow starts with a POST request. The request includes a client identification code (",(0,i.jsx)(n.code,{children:"ClientID"}),")."]}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Information retrieval"}),(0,i.jsx)(n.br,{}),"\n","The system uses the ",(0,i.jsx)(n.code,{children:"ClientID"})," to fetch additional order details from an internal purchasing endpoint."]}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Data transformation with JSONata"}),(0,i.jsx)(n.br,{}),"\n","A ",(0,i.jsx)(n.strong,{children:"JSONata"})," expression restructures the data and formats it for the next step."]}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Payment processing via an external endpoint"}),(0,i.jsx)(n.br,{}),"\n","The system sends the payment request to an external endpoint and processes the response."]}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Data transformation with JSONata"}),(0,i.jsx)(n.br,{}),"\n","JSONata restructures the returned data again, preparing it for the final steps."]}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Status update and confirmation"}),(0,i.jsx)(n.br,{}),"\n","The system updates the order status in an internal endpoint. It also receives and records the payment confirmation."]}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(n.h2,{id:"data-transformation-with-jsonata",children:"Data transformation with JSONata"}),"\n",(0,i.jsxs)(n.blockquote,{children:["\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Structure & Objectives"})}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"Demonstrate how to add and configure JSONata"}),"\n",(0,i.jsx)(n.li,{children:"Check logs and traces"}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(n.p,{children:["Hi, everyone!",(0,i.jsx)(n.br,{}),"\n","In this step, we will perform another data transformation using JSONata."]}),"\n",(0,i.jsx)(n.h3,{id:"body-transformation-with-jsonata",children:"Body transformation with JSONata"}),"\n",(0,i.jsxs)(n.p,{children:["We will add a ",(0,i.jsx)(n.strong,{children:"SetBody"})," step to combine the result of the payment processing with the ",(0,i.jsx)(n.strong,{children:"ClientID"}),"."]}),"\n",(0,i.jsxs)(n.p,{children:["To redefine the message body, we will select the ",(0,i.jsx)(n.strong,{children:"Simple"})," language again in the expression field. It allows referencing headers, properties, the message body, and performing simple operations such as concatenation, conditions, and transformations."]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-yaml",metastring:'title="Using Simple language"',children:'- setBody:\n         expression:\n           simple:\n             expression: \'{"ClientID": "${exchangeProperty.ClientID}", "status":${body}}\'\n'})}),"\n",(0,i.jsx)(n.p,{children:"Essentially, we are creating a JSON that combines:"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:["The ClientID stored in the ",(0,i.jsx)(n.code,{children:"ClientID"})," property"]}),"\n",(0,i.jsx)(n.li,{children:"Anda the status coming from the original body."}),"\n"]}),"\n",(0,i.jsx)(n.h3,{id:"adding-a-log-step",children:"Adding a log step"}),"\n",(0,i.jsx)(n.p,{children:"Next, we add a Log step to record the result of the combined information. We will used the prefix \u201cConcatenation\u201d to indicate that the body data has been concatenated."}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-yaml",metastring:'title="Adding the log step"',children:"     - log:\n         message: CONCATENATION - ${body}\n"})}),"\n",(0,i.jsx)(n.h3,{id:"creating-a-resource",children:"Creating a resource"}),"\n",(0,i.jsxs)(n.p,{children:["In the Source Code tab, we will create a resource with the transformation instructions, which will be called ",(0,i.jsx)(n.code,{children:"statusPayload.jsonata"}),"."]}),"\n",(0,i.jsxs)(n.p,{children:["Click ",(0,i.jsx)(n.strong,{children:"+"})," next to \u201cResources\u201d and add the transformation instructions:"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-json",metastring:'title="Creating the transformation instruction in JSONata"',children:'{\n    "ClientID":ClientID,\n    "Status":status.status\n}\n'})}),"\n",(0,i.jsx)(n.p,{children:"This JSONata expression creates a new JSON object by extracting and organizing values from the original JSON."}),"\n",(0,i.jsx)(n.p,{children:"For example, if the original JSON is:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-json",metastring:'title="Example"',children:'{\n  "ClientID": "1",\n  "status": {\n    "status": "Paid"\n  }\n}\n'})}),"\n",(0,i.jsx)(n.p,{children:"The JSONata expression produces the following result:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-json",metastring:'title="Result"',children:'{\n  "ClientID": "1",\n  "Status": "Paid"\n}\n'})}),"\n",(0,i.jsxs)(n.p,{children:["In other words, the expression simply reorganizes the data, keeping the ",(0,i.jsx)(n.code,{children:"ClientID"})," and extracting the status field from a nested object."]}),"\n",(0,i.jsxs)(n.p,{children:["We assign the name and extension ",(0,i.jsx)(n.code,{children:"statusPayload.jsonata"})," and save the file."]}),"\n",(0,i.jsx)(n.h3,{id:"using-the-jsonata-component",children:"Using the JSONata component"}),"\n",(0,i.jsx)(n.p,{children:"After creating the resource with the transformation instructions, we will create a step using the JSONata component."}),"\n",(0,i.jsxs)(n.p,{children:["Remember that the ",(0,i.jsx)(n.code,{children:"statusPayload.jsonata"})," file is referenced in the ",(0,i.jsx)(n.code,{children:"classpath"}),"."]}),"\n",(0,i.jsx)(n.h3,{id:"adding-another-log-step",children:"Adding another log step"}),"\n",(0,i.jsx)(n.p,{children:'Now we add a Log step to record the body from the previous step. We will use the prefix "PAYLOAD STATUS".'}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-yaml",metastring:'title="Adding the log step"',children:"     - log:\n         message: 'PAYLOAD STATUS - ${body}'\n\n"})}),"\n",(0,i.jsx)(n.h3,{id:"checking-logs-and-traces",children:"Checking logs and traces"}),"\n",(0,i.jsx)(n.p,{children:"Finally, we will check the logs and traces for this step."}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"In the traces, we can see information related to the product and the JSONata step."}),"\n",(0,i.jsxs)(n.li,{children:["In the logs, we can see:","\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"The result of the concatenation between ClientID and the payment processing data."}),"\n",(0,i.jsxs)(n.li,{children:["Then, we can see the transformed payment data recorded with the prefix ",(0,i.jsx)(n.code,{children:"PAYLOAD STATUS"}),"."]}),"\n"]}),"\n"]}),"\n"]})]})}function h(e={}){const{wrapper:n}={...(0,a.R)(),...e.components};return n?(0,i.jsx)(n,{...e,children:(0,i.jsx)(c,{...e})}):c(e)}},8453:(e,n,t)=>{t.d(n,{R:()=>r,x:()=>o});var s=t(6540);const i={},a=s.createContext(i);function r(e){const n=s.useContext(a);return s.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function o(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(i):e.components||i:r(e.components),s.createElement(a.Provider,{value:n},e.children)}}}]);